{% extends 'ecommerce/base.html' %}

{% load static %}

{% block content %}

<div class="main__container">
    <div class="intro__container">
        <div id="cont1">
            <div class="rutas__container">
                {% for path, name in request.breadcrumbs %}
                    {% if forloop.first %}
                        <!-- Primer breadcrumb, 'Inicio', con enlace -->
                        <a href="{% url 'ecommerce:index' %}">{{ name }}</a>
                        <span> > </span> <!-- Separador -->
                    {% elif forloop.last %}
                        <!-- Última migaja de pan (sin enlace) con la clase 'last-breadcrumb' -->
                        <span>{{ name }}</span>
                    {% else %}
                        <!-- Para las migas de pan intermedias, generamos la URL correcta según la vista -->
                        {% if name == 'Calzados' %}
                            <a href="{% url 'ecommerce:lista_calzados' %}">{{ name }}</a>
                        {% elif name == 'Indumentaria' %}
                            <a href="{% url 'ecommerce:lista_indumentaria' %}">{{ name }}</a>
                        {% elif name == 'Accesorios' %}
                            <a href="{% url 'ecommerce:lista_accesorios' %}">{{ name }}</a>
                        {% elif name == 'Sale' %}
                            <a href="{% url 'ecommerce:sale' %}">{{ name }}</a>
                        {% else %}
                            <a href="{{ path }}">{{ name }}</a>
                        {% endif %}
                        <span> > </span> <!-- Separador -->
                    {% endif %}
                {% endfor %}
            </div>
            
            
            
            
            
            
            
            
            
            <div class="container__categoria">
                <h3>{% block tittle-categoria %}{% endblock %}</h3>
            </div>
        </div>
    
        <div class="container__button-filtros" id="container-filtro">
            <button id="toggle-filters" class="toggle-filters">
                Filtros
                <i class="bi bi-filter-right"></i>
            </button>
            <form class="form__order" id="order-form" method="GET" action="{% block filtro_url %}{% endblock %}">
                <select name="ordenar" id="ordenar">
                    <option value="">Seleccionar</option>
                    <option value="precio_asc" {% if request.GET.ordenar == 'precio_asc' %}selected{% endif %}>Precio: Bajo a Alto</option>
                    <option value="precio_desc" {% if request.GET.ordenar == 'precio_desc' %}selected{% endif %}>Precio: Alto a Bajo</option>
                    <option value="nombre_asc" {% if request.GET.ordenar == 'nombre_asc' %}selected{% endif %}>Nombre: A-Z</option>
                    <option value="nombre_desc" {% if request.GET.ordenar == 'nombre_desc' %}selected{% endif %}>Nombre: Z-A</option>
                </select>
                <button type="submit" class="order-button">Buscar</button>
            </form>
        </div>  
    </div>
    
    <div class="wrapper">
            <aside id="aside-filters" class="aside-filters">

                {% block filtros_genero %}

                {% endblock %}
                
                <form method="GET" id="filter-form" action="{% block filtro_form %}{% endblock %}">
                    <div class="container__filtros-tittle">
                        <span id="close-filters">X</span>
                        <h2 class="filtros-tittle">Filtrar Por</h2>
                    </div>
                <div class="container__flex-filtros">
                    <div class="container__filtro">
                        <h3>Marca</h3>
                        {% for marca in marcas %}
                            {% if forloop.counter <= 8 %}
                        <label>
                            <div class="label-content">
                                <input type="checkbox" name="marca" value="{{ marca.id }}" {% if marca.id|stringformat:"d" in request.GET.marca %}checked{% endif %}>
                                <span>{{ marca.nombre }}</span>
                            </div>
                        </label>
                            {% endif %}
                        {% endfor %}
                        <div class="more-filters-marca" id="filters-marca">
                            {% for marca in marcas %}
                                {% if forloop.counter > 8 %}
                                <label>
                                    <div class="label-content">
                                        <input type="checkbox" name="marca" value="{{ marca.id }}">
                                        <span>{{ marca.nombre }}</span>
                                    </div>
                                </label>
                                {% endif %}
                            {% endfor %}
    
                        </div>
                        <button id="button-filtro-marca" type="button">Ver todos</button>
                    </div>
    
    
                    <div class="container__filtro">
                        <h3>Color</h3>
                        {% for color in colores %}
                            {% if forloop.counter <= 8 %}  {# Muestra solo los primeros 8 #}
                            <label>
                                <div class="label-content">
                                    <input type="checkbox" name="colores" value="{{ color.id }}">
                                    <span>{{ color.nombre }}</span>
                                </div>
                                <i class="bi bi-circle-fill" style="color: {{ color.color_style }}; font-size: small;"></i>
                            </label>
                            {% endif %}
                        {% endfor %}
                    
                        <div class="more-filters" id="more-filters">
                            {% for color in colores %}
                                {% if forloop.counter > 8 %}
                                <label>
                                    <div class="label-content">
                                        <input type="checkbox" name="colores" value="{{ color.id }}">
                                        <span>{{ color.nombre }}</span>
                                    </div>
                                    <i class="bi bi-circle-fill" style="color: {{ color.color_style }}; font-size: small;"></i>
                                </label>
                                {% endif %}
                            {% endfor %}
                            
                        </div>
                        <button id="button-filtro" type="button">Ver todos</button>
                    </div>
    
                    {% block talle %}
                        
                    {% endblock %}
    
                    <button type="submit" class="button-filtrar">Filtrar</button>
                </div>   
            </form>
            
    
        </aside>
        <main id="main">
            
        <div class="container" id="container-principal">
    
            {% block products %}

            {% endblock %}

        </div> 
    
        </main>
        </div>
</div>
    {% endblock content %}